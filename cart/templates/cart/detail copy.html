{% extends "shop/base.html" %}
{% load static %}

{% block title %}
  Your shopping cart
{% endblock %}

{% block content %}
<div class="text-center"><!-- 가운데정렬  -->
    <h1>장바구니</h1>
</div>
<div class="container py-4">
    <!-- Flexbox를 사용하여 좌우로 나란히 배치 -->
    <div class="d-flex justify-content-between">
        <!-- 왼쪽 영역: 상품 목록 -->
        <div class="card w-75 me-3">

            <div class="card-header">
                <input type="checkbox"> 전체 선택 {{ 0 }}/{{ 0 }}
            </div>

            <div class="card-body">
                {% for delivery, packaging_dict in grouped_items.items %}
                    <h3>{{ delivery }}</h3> <!-- 배송방식 -->
                    {% for packaging, items in packaging_dict.items %}
                    <h4>{{ packaging }} 상품</h4> <!-- 포장방식 -->
                        {% for item in items %}</div>
                            <div>{{ item.product.product_name }}</div> <!-- 상품명 -->
                            <div style="justify-content: flex-end;">
                                <form action="{% url 'cart:cart_remove' item.product.id %}"> <!-- 제거버튼 -->
                                    {% csrf_token %}
                                    <button type="submit">X</button>
                                </form>
                            </div>
                            <div class="d-flex justify-content-between" style="margin-left: 50px; margin-right: 50px;">
                                <div class="flex-grow-2" style="flex-basis: 30%;">
                                    <a href="item.product.get_absolute_url">
                                        <img src="{% if item.product.image %}{{ item.product.image.url }}
                                        {% else %}{% static 'img/no_image.png' %}
                                        {% endif %}" width="90" height="60">
                                    </a>
                                </div>
                                <div class="flex-grow-2" style="flex-basis: 70%;">
                                    <form action="{% url 'cart:cart_update' item.product.id %}" method="post">
                                        {% csrf_token %}
                                        <input type="submit" name="action" value="-">
                                        {{ item.quantity}}
                                        <input type="submit" name="action" value="+">
                                    </form>
                                </div>
                            </div>
                            {% endfor %}
                    {% endfor %}
                {% endfor %}
            </div>

            <div class="card-footer">
                상품 원 + 배송비 무료<br>
                <strong>총 결제금액: 원</strong>
            </div>
        </div>

        <!-- 오른쪽 영역: 결제 정보 -->
        <div class="card w-25">
            <div class="card-body">
                <h5 class="card-title">결제 금액</h5>
                <p>상품 금액: 원</p>
                <p>상품 할인 금액: 원</p>
                <p>배송비: 원</p>
                <hr>
                <p>결제 예정 금액: 원</p>
                <button type="button" class="btn btn-primary btn-block">로그인</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
